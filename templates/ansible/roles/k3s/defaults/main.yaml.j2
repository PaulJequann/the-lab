---
k3s_version: {{ k3s_version }}
k3s_config_file: /etc/rancher/k3s/config.yaml
k3s_token_file: /etc/rancher/node/password
k3s_service_file: /etc/systemd/system/k3s.service
k3s_data_dir: /var/lib/rancher/k3s
k3s_kubeconfig_file: /etc/rancher/k3s/k3s.yaml
control_plane_endpoint: "{{ control_plane_endpoint }}"
kube_vip_version: "{{ kube_vip_version }}"

# Force configuration update
k3s_force_config_update: true
k3s_server_config:
  cluster-cidr: "{{ cluster_cidr }}"
  service-cidr: "{{ service_cidr }}"
  tls-san:
    - "{{ control_plane_endpoint }}"
  disable:
    - local-storage
    - servicelb
    - traefik
  # something below is breaking kube-vip being available. or servicelb above...
  disable-helm-controller: true
#  disable-kube-proxy: true
  disable-network-policy: true
  flannel-backend: none
  secrets-encryption: true
